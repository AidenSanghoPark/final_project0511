<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dsn.designer">
	<select id="portfolio" parameterType="Map" resultType="dsn.designer.model.DesignerDTO">
		select * from 
			(select rownum as rnum, a.* from
			(select * from f_designer order by d_idx desc)a)b
		where
			rnum <![CDATA[>=]]> #{start}
		and
			rnum <![CDATA[<=]]> #{end}
	</select>
	<select id="review" parameterType="Map" resultType="dsn.review.model.ReviewDTO">
  		select * from 
			(select rownum as rnum, a.* from
			(select * from f_review order by u_idx desc)a)b
		where
			rnum <![CDATA[>=]]> #{start}
		and
			rnum <![CDATA[<=]]> #{end}
  	</select>
	<select id="portfolioTotalCnt" resultType="Integer">
		select count(*) from f_designer
	</select>
	<select id="reviewTotalCnt" resultType="Integer">
		select count(*) from f_review
	</select>
	<select id="designerTotalCnt" resultType="Integer">
		select count(*) from f_user
	</select>
	<insert id="profileInsert" parameterType="dsn.profile.model.ProfileDTO">
		insert into
			f_profile
		values(
			p_idx.nextval,
			#{u_idx},
			#{p_img},
			#{p_info},
			#{u_wallet}
		)
	</insert>
	<update id="profileUpdate" parameterType="dsn.profile.model.ProfileDTO">
		update
			f_profile
		set
			p_img=#{p_img},
			p_info=#{p_info},
			u_wallet=#{u_wallet}
		where
			u_idx=#{u_idx}
	</update>
	<select id="designerWin" parameterType="Integer" resultType="Integer">
		select
			count(d_win)
		from
			f_designer
		where
			u_idx=#{u_idx}
	</select>
	<select id="profileInfo" parameterType="Integer" resultType="dsn.profile.model.ProfileDTO">
		select
			*
		from
			f_profile
		where
			u_idx=#{u_idx}
			
	</select>
	<select id="userInfo" parameterType="Integer" resultType="dsn.member.model.MemberDTO">
		select
			*
		from
			f_user
		where
			u_idx=#{u_idx}
	</select>
	<select id="designerList" parameterType="Map" resultType="dsn.member.model.MemberDTO">
		select * from 
			(select rownum as rnum, a.* from
			(select * from f_user order by u_idx desc)a)b
		where
			rnum <![CDATA[>=]]> #{start}
		and
			rnum <![CDATA[<=]]> #{end}
	</select>
	<select id="designPhotos" parameterType="Map" resultType="dsn.designer.model.DesignerDTO">
		select * from
			(select rownum as rnum, a.*from
			(select d_img_1, u_idx from f_designer order by d_idx desc)a)b
		where
		    rnum <![CDATA[>=]]> 0
		and
			rnum <![CDATA[<=]]> 3
		and
			u_idx=#{u_idx}
	</select>
	<select id="designerListByIdx" parameterType="Map" resultType="dsn.designer.model.DesignerDTO">
		select * from 
			(select rownum as rnum, a.* from
			(select * from f_user where u_idx=#{u_idx} order by u_idx desc)a)b
		where
			rnum <![CDATA[>=]]> #{start}
		and
			rnum <![CDATA[<=]]> #{end}
	</select>
	<select id="getDesignerCnt" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM F_DESIGNER WHERE U_IDX=#{u_idx}
	</select>
</mapper>